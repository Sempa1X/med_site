{% extends 'base/base.html' %}


{% block content %}

<div class="container" id='cont'>
    <div class="row mb-5">
        <div class="col">
            <form id='searchFormtest' action="/reception/reception_process">
                <div id="sandbox-container" class="d-flex justify-content-center"></div>
            </form>
        </div>
    </div>
        <!-- <div class="col-sm-3" id='col_1'>
            <div>
                <p class="text-center mb-1">ФИО Врача</p>
                <p class="text-center">Кабинет №1</p>
            </div>
            <div class="overflow-auto" id='scroll' style="max-height: 40vh; padding-right: 5px;">
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">09:30</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">10:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">10:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">11:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">11:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">12:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">12:30</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">13:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">13:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">14:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">14:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">15:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
            </div>
        </div> -->
        <!-- <div class="col-sm-3" id='col_1' c>
            <div>
                <p class="text-center mb-1">ФИО Врача</p>
                <p class="text-center">Кабинет №2</p>
            </div>
            <div class="overflow-auto" id='scroll' style="max-height: 40vh; padding-right: 5px;">
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
            </div>
        </div> -->
        <!-- <div class="col-sm-3" id='col_1' style="max-height: 40vh;">
            <div>
                <p class="text-center mb-1">ФИО Врача</p>
                <p class="text-center">Кабинет №3</p>
            </div>
            <div class="overflow-auto" id='scroll' style="max-height: 40vh; padding-right: 5px;">
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
                    <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
                    <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
                <div class="input-group input-group-sm mb-2">
                    <span class="input-group-text btn-primary text-white" id="addons">09:00</span>
                    <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
                </div>
            </div>
        </div>
        <div class="col-sm-3" id='col_1' style="max-height: 50vh;">
            <div>
                <p class="text-center mb-1">ФИО Врача</p>
                <p class="text-center">Кабинет №4</p>
            </div>
            <div class="overflow-auto" id='scroll' style="max-height: 40vh; padding-right: 5px;">
                <div class="text-center">
                    <h5 class="mb-3">Расписание отсутствует</h5>
                    <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-edit"></i> Добавить</button>
                </div>
            </div>
        </div> -->
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.ru.min.js"></script>

<script>
    $(document).ready(function() { 
        get_doctors();
    });

    function get_doctors() {
        url = '/reception/get_doctors'
        var posting = $.post( url );

        posting.done(function( data ) {
            if (data.success == "false") {
                toastr["error"]("Произошла ошибка, пожалуйста попробуйте еще раз или обратитесь к администратору.", "Ошибка!");
            }
            else {
                // console.log(data.doctors);
                toastr["success"]("Успешно!");
                createForm(data.doctors);
                // for (count in data.doctors) {
                //     createForm(count, data.doctors[count])
                //     console.log(data.doctors[count]);
                // }
            }
        });
    };

    $('#sandbox-container').datepicker({
        format: "yyyy-mm-dd",
        startView: 2,
        maxViewMode: 2,
        todayBtn: "linked",
        language: "ru",
        daysOfWeekDisabled: "0",
        autoclose: true,
        todayHighlight: true,
    }).on('changeDate', showTestDate);
    function showTestDate() {
        console.log($('#sandbox-container').datepicker('getFormattedDate'));

        event.preventDefault();
    
        var $form = $( '#searchFormtest' ),
            term = $form.find( "#sandbosssx-container" ).val(),
            url = $form.attr( "action" );
    
        // Send the data using post
        var posting = $.post(url, { date: $('#sandbox-container').datepicker('getFormattedDate') } );
    
        // Put the results in a div
        posting.done(function( data ) {
            if (data.success == "false") {
                toastr["warning"]("Не найдены записи на сегодня.", "Предупреждение!");
            }
            else {
                for (var a = 0; a < data.data.length; a++) {
                    createForm(data);
                    console.log(data.data[a].full_name + a)
                    console.log(data.data[a].trust_factor + a)
                    console.log(data.data[a].role + a)
                    console.log(data.data[a].comment + a)
                    console.log(data.data[a].phone + a)

                }
            }
        });
    };

    function delBlock() {
        if ($('#data_place').length) {
            $("#data_place").empty();
        }
    }
    
    function createForm(data) {
        delBlock()
        // <div class="col-sm-3" id='col_1'>
        //     <div>
        //         <p class="text-center mb-1">ФИО Врача</p>
        //         <p class="text-center">Кабинет №1</p>
        //     </div>
        //     <div class="overflow-auto" id='scroll' style="max-height: 40vh; padding-right: 5px;">
        //         <div class="input-group input-group-sm mb-2">
        //             <span class="input-group-text btn-secondary text-white" id="addons">08:00</span>
        //             <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
        //             <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
        //             <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
        //         </div>
        //         <div class="input-group input-group-sm mb-2">
        //             <span class="input-group-text btn-secondary text-white" id="addons">08:30</span>
        //             <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
        //             <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
        //         </div>
        //         <div class="input-group input-group-sm mb-2">
        //             <span class="input-group-text btn-secondary text-white" id="addons">09:00</span>
        //             <input type="text" class="form-control" placeholder="Добавить" aria-label="Username" aria-describedby="addons">
        //             <button class="btn btn-outline-primary" type="button"><i class="bx bx-calendar-plus"></i></button>
        //         </div>
        //         <div class="input-group input-group-sm mb-2">
        //             <span class="input-group-text btn-secondary text-white" id="addons">09:30</span>
        //             <input type="text" class="form-control" placeholder="ФИО" aria-label="Username" aria-describedby="addons">
        //             <button class="btn btn-outline-success" type="button"><i class="bx bx-calendar-check"></i></button>
        //             <button class="btn btn-outline-danger" type="button"><i class="bx bx-calendar-x"></i></button>
        //         </div>
        //     </div>
        // </div>
        $("<div/>").attr({id: 'data_place'}).appendTo('#cont');
        $("<div/>").attr({id: 'row', class: 'row'}).appendTo('#data_place');
        for (let count = 0; count < data.length; count++) {
            console.log(count)
            $("<div/>").attr({id: `col_${count}`, class: 'col-sm-3'}).appendTo(`#row`);
            $("<div/>").attr({id: `head_${count}`}).appendTo(`#col_${count}`);
            $("<p/>").attr({id: `head_fio_${count}`, class: 'text-center mb-1'}).appendTo(`#head_${count}`);
            document.getElementById(`head_fio_${count}`).textContent = data[count].doc_full_name;
            $("<p/>").attr({id: `head_office_${count}`, class: 'text-center'}).appendTo(`#head_${count}`);
            if (data[count].records.length > 0) {
                document.getElementById(`head_office_${count}`).textContent = `Кабинет №${data[count].records[0].office}`;
                $("<div/>").attr({id: `scroll_${count}`, class: 'overflow-auto', style: "max-height: 40vh; padding-right: 5px;"}).appendTo(`#col_${count}`);
                for (item_count = 0; item_count < data[count].records.length; item_count++) {
                    $("<div/>").attr({id: `scroll_item_${item_count}`, class: 'input-group input-group-sm mb-2'}).appendTo(`#scroll_${count}`);
                    // if (data[count].records.date == )
                    $("<span/>").attr({id: `scroll_item_span_${item_count}`, class: 'input-group-text btn-secondary text-white'}).appendTo(`#scroll_item_${item_count}`);
                    document.getElementById(`scroll_item_span_${item_count}`).textContent = 11;
                    $("<input/>").attr({id: `scroll_item_input_${item_count}`, class: 'form-control', type: 'text', placeholder: 'фио', 'aria-describedby': `scroll_item_span_${item_count}`}).appendTo(`#scroll_item_${item_count}`);
                }
            }
            else {
                $("<div/>").attr({id: `records_${count}`, class: 'text-center'}).appendTo(`#col_${count}`);
                $("<h5/>").attr({id: `not_record_h5_${count}`, class: 'mb-3'}).appendTo(`#records_${count}`);
                document.getElementById(`not_record_h5_${count}`).textContent = 'Расписание отсутствует';
                $("<button/>").attr({id: `not_record_button_${count}`, class: 'btn btn-outline-primary', type: 'button'}).appendTo(`#records_${count}`);
                $("<i/>").attr({class: 'bx bx-calendar-edit'}).appendTo(`#not_record_button_${count}`);
                document.getElementById(`not_record_button_${count}`).textContent = ' Добавить';
            }
        }
    }
</script>

{% endblock %}

