{% extends 'base.html' %}
{% include 'style.html' %}
{% block title %}DEV{% endblock %}

{% block content %}
{% include 'leftside.html' %}

<style>
    .no_viseble{
        color: aliceblue;
        background-color: aliceblue;
    }
    .no_viseble {
        visibility: hidden;
        }
   
</style>
	<!--Container Main start-->
    <div class="height-100 bg-light">
        <h2>Расписание доктора</h2>
        <div class="container-sm">
            <div class="row">
                <div class="d-flex justify-content-center">
                    <form method="post">
                        <div class="form">
                            <div class="input-group">
                                <span class="input-group-text">Время с : до</span>
                                <input id="after" type="text" aria-label="First name" class="form-control after">
                                <input id="before" type="text" aria-label="Last name" class="form-control before">
                              </div>

                            <select onchange="test(this)" name="step" class="form-select" aria-label="Пример выбора по умолчанию">
                                <option value="15">15 мин</option>
                                <option value="30">30 мин</option>
                                <option value="45">45 мин</option>   
                                <option value="60">60 мин</option>
                            </select>
                        </div>



                        <button type="submit" class="btn btn-primary">Отправить</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
<script>
    function test(obj){
        if (obj.selectedIndex) {
            let start = document.getElementById("after").value;
            let end = document.getElementById("before").value;
            let _start = moment(start, 'HH:mm');
            let _end = moment(end, 'HH:mm');
            
            let result = [];
            
            while (_start <= _end) {
              result.push(_start.format('HH:mm'));
              _start.add(obj.value, 'minutes');
            }
            var nodes = document.querySelectorAll('.amount');
            for (var i = 0; i < nodes.length; i++)
            nodes[i].parentNode.removeChild(nodes[i]);


            var $add = document.getElementsByClassName('add')[0];
            var $form = document.getElementsByClassName('form')[0];
    
            for (let i = 0; i < result.length; i++){
            var $input = document.createElement('input');
            $input.name = 'value_' + i;
            $input.type = 'text';
            $input.value = result[i];
            $input.classList.add('amount');
            $form.insertBefore($input, $add);
            }
        }
        else{
            let start = '12:00';
            let end = '16:00';
            let _start = moment(start, 'HH:mm');
            let _end = moment(end, 'HH:mm');
            
            let result = [];
            
            while (_start <= _end) {
              result.push(_start.format('HH:mm'));
              _start.add(obj.value, 'minutes');
            }
            var nodes = document.querySelectorAll('.amount');
            for (var i = 0; i < nodes.length; i++)
            nodes[i].parentNode.removeChild(nodes[i]);
            
            
            var $add = document.getElementsByClassName('add')[0];
            var $form = document.getElementsByClassName('form')[0];
    
            for (let i = 0; i < result.length; i++){
            var $input = document.createElement('input');
            $input.type = 'text';
            $input.value = result[i];
            $input.classList.add('amount');
            $form.insertBefore($input, $add);
            }
        }
        var $add = document.getElementsByClassName('add')[0];
        var $form = document.getElementsByClassName('form')[0];

        var $input = document.createElement('input');
        $input.type = 'text';
        $input.name = 'value_all';
        $input.value = result.length;
        $input.classList.add('');
        $form.insertBefore($input, $add);
    }
    </script>     



<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.7.0/moment.min.js" type="text/javascript"></script>
{% endblock %}